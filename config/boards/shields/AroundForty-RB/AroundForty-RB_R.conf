############################################################
# AroundFortyRB_R (RIGHT / CENTRAL) - Debug + Bond Repair
############################################################

# ------------------------
# Bond repair (起動時にbond全消去)
# ------------------------
CONFIG_ZMK_BLE_CLEAR_BONDS_ON_START=y


# ------------------------
# Split basics (Central)
# ------------------------
CONFIG_ZMK_SPLIT=y
CONFIG_ZMK_SPLIT_BLE=y
CONFIG_ZMK_SPLIT_ROLE_CENTRAL=y


# ------------------------
# Keyboard Identification / AroundFortyRB_R
############################################################
CONFIG_ZMK_KEYBOARD_NAME="AroundFortyRB"
CONFIG_BT_DEVICE_NAME="AroundFortyRB"
CONFIG_BT_DEVICE_NAME_MAX=16


# ------------------------
# Core ZMK Features
# ------------------------
CONFIG_ZMK_BLE=y
CONFIG_ZMK_POINTING=y


# ------------------------
# nRF52840 Hardware Specific
# ------------------------
# NOTE: Deprecated warningが出る場合があります。
#       「Kconfig warningsをerror扱い」している環境だと止まるので、
#       もしビルドが止まるなら一旦コメントアウトしてください。
CONFIG_NFCT_PINS_AS_GPIOS=y


# ------------------------
# Logging
# ------------------------
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=4
CONFIG_LOG_MODE_IMMEDIATE=y
CONFIG_PRINTK=y

# USB CDC ACM console（※あなたの環境では USB_UART_CONSOLE が未定義なので使わない）
CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_CDC_ACM=y
CONFIG_USB_DEVICE_INITIALIZE_AT_BOOT=y
CONFIG_SERIAL=y
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y
CONFIG_LOG_BACKEND_UART=y


############################################################
# Bluetooth (Zephyr BLE stack) Memory / Buffer Tuning
############################################################

# Bluetooth RX 処理用スレッドのスタックサイズ（bytes）
CONFIG_BT_RX_STACK_SIZE=2048

# Bluetooth HCI TX（送信）処理用スタックサイズ（bytes）
CONFIG_BT_HCI_TX_STACK_SIZE=1024

# Bluetooth ACL RX/TX バッファサイズ（bytes）
CONFIG_BT_BUF_ACL_RX_SIZE=251
CONFIG_BT_BUF_ACL_TX_SIZE=251

# BLE 試験的機能（無効）
CONFIG_ZMK_BLE_EXPERIMENTAL_FEATURES=n

# 接続パラメータ（15ms固定）
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=12
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=12

# 出力パワー
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y

# PHY（安定性優先で2M無効）
CONFIG_BT_CTLR_PHY_2M=n


############################################################
# Sleep / Idle
############################################################
CONFIG_ZMK_SLEEP=y
CONFIG_ZMK_IDLE_TIMEOUT=30000
CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=1800000


############################################################
# Bluetooth connection / pairing limits
# （子機1 + ホスト最大5 = 6）
############################################################
CONFIG_BT=y
CONFIG_BT_MAX_CONN=6
CONFIG_BT_MAX_PAIRED=6


############################################################
# Zephyr Driver Subsystems
############################################################
CONFIG_SPI=y
CONFIG_INPUT=y


############################################################
# PMW3610 ALT driver
############################################################
CONFIG_PMW3610=y
CONFIG_PMW3610_SMART_ALGORITHM=y

CONFIG_PMW3610_REPORT_INTERVAL_MIN=15
CONFIG_PMW3610_RUN_DOWNSHIFT_TIME_MS=3264
CONFIG_PMW3610_REST1_SAMPLE_TIME_MS=20
CONFIG_PMW3610_REST3_SAMPLE_TIME_MS=300
CONFIG_PMW3610_INIT_POWER_UP_EXTRA_DELAY_MS=1000



############################################################
# RGB LED Widget
############################################################
CONFIG_RGBLED_WIDGET=y
CONFIG_RGBLED_WIDGET_BATTERY_LEVEL_HIGH=30
CONFIG_RGBLED_WIDGET_BATTERY_LEVEL_CRITICAL=10
CONFIG_RGBLED_WIDGET_SHOW_LAYER_CHANGE=y


############################################################
# Battery Reporting (Split Keyboard Support)
############################################################
CONFIG_ZMK_BATTERY_REPORTING=y
CONFIG_ZMK_SPLIT_BLE_CENTRAL_BATTERY_LEVEL_PROXY=y
CONFIG_ZMK_SPLIT_BLE_CENTRAL_BATTERY_LEVEL_FETCHING=y
CONFIG_BT_BAS=y


############################################################
# Thread / Stack Size Tuning
############################################################
CONFIG_ZMK_BLE_THREAD_STACK_SIZE=2048
CONFIG_ZMK_LOW_PRIORITY_THREAD_STACK_SIZE=2048
CONFIG_INPUT_THREAD_STACK_SIZE=2048

# Split Central 側ランタイム処理スタック
CONFIG_ZMK_SPLIT_BLE_CENTRAL_SPLIT_RUN_STACK_SIZE=3096

# IMPORTANT:
# Right(Central) には Peripheral_STACK_SIZE を書かない（警告→エラーになる）
# CONFIG_ZMK_SPLIT_BLE_PERIPHERAL_STACK_SIZE=2048  ← Left側にのみ置く
