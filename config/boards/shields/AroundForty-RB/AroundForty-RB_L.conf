############################################################
# AroundFortyRB_L (LEFT / PERIPHERAL) - Debug + Bond Repair
############################################################

# ------------------------
# Bond repair (起動時にbond全消去)
# ------------------------
CONFIG_ZMK_BLE_CLEAR_BONDS_ON_START=y


# ------------------------
# Split basics (Peripheral)
# ------------------------
CONFIG_ZMK_SPLIT=y
CONFIG_ZMK_SPLIT_BLE=y

CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y


# ------------------------
# Keyboard Identification / AroundFortyRB_L
# ------------------------
CONFIG_ZMK_KEYBOARD_NAME="AroundFortyRB"

# peripheralは通常OSに直接つながらないけど、デバッグ識別用に分けたいなら _L 推奨
# ただし、Rightと同一名でもSplit自体は動きます
CONFIG_BT_DEVICE_NAME="AroundFortyRB_L"
CONFIG_BT_DEVICE_NAME_MAX=16


# ------------------------
# Core ZMK Features
# ------------------------
CONFIG_ZMK_BLE=y
CONFIG_ZMK_USB=y
CONFIG_INPUT=y


# ------------------------
# nRF52840 Hardware Specific
# ------------------------
# NOTE: Deprecated warningが出る場合があります。
#       「Kconfig warningsをerror扱い」している環境だと止まるので、
#       もしビルドが止まるなら一旦コメントアウトしてください。


# ------------------------
# Logging (最小)
# ------------------------
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=4
CONFIG_LOG_MODE_IMMEDIATE=y
CONFIG_PRINTK=y

# USB CDC ACM（あなたの環境では USB_UART_CONSOLE が未定義になり得るため入れない）
CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_CDC_ACM=y
CONFIG_USB_DEVICE_INITIALIZE_AT_BOOT=y
CONFIG_SERIAL=y
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y
CONFIG_UART_LINE_CTRL=y
CONFIG_LOG_BACKEND_UART=y


############################################################
# BLE experimental features (無効)
############################################################
CONFIG_ZMK_BLE_EXPERIMENTAL_FEATURES=n


############################################################
# Bluetooth (Zephyr BLE stack) Memory / Buffer Tuning
############################################################
CONFIG_BT_RX_STACK_SIZE=2048
CONFIG_BT_BUF_ACL_RX_SIZE=251
CONFIG_BT_BUF_ACL_TX_SIZE=251

# 接続パラメータ（15ms固定）
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=12
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=12

# PHY（安定性優先で2M無効）
CONFIG_BT_CTLR_PHY_2M=n


############################################################
# Sleep / Idle
############################################################
CONFIG_ZMK_SLEEP=y
CONFIG_ZMK_IDLE_TIMEOUT=30000
CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=1800000


############################################################
# Heap
############################################################
CONFIG_HEAP_MEM_POOL_SIZE=16384


############################################################
# RGB LED Widget
############################################################
CONFIG_RGBLED_WIDGET=y
CONFIG_RGBLED_WIDGET_BATTERY_LEVEL_HIGH=30
CONFIG_RGBLED_WIDGET_BATTERY_LEVEL_CRITICAL=10


############################################################
# Battery Reporting
############################################################
CONFIG_ZMK_BATTERY_REPORTING=y
CONFIG_BT_BAS=y


############################################################
# Thread / Stack Size Tuning
############################################################
CONFIG_ZMK_BLE_THREAD_STACK_SIZE=2048
CONFIG_ZMK_LOW_PRIORITY_THREAD_STACK_SIZE=2048
CONFIG_INPUT_THREAD_STACK_SIZE=2048

# Split Peripheral 側 BLE スタック（Leftだけ）
CONFIG_ZMK_SPLIT_BLE_PERIPHERAL_STACK_SIZE=2048


############################################################
# Bluetooth connection / pairing limits
############################################################
# peripheralは基本「central(右)に1本」なので、デバッグ目的は1が安定
# ※ どうしても左右で揃えたいなら 6 に戻してOK（ただしRAM圧迫しやすい）
CONFIG_BT_MAX_CONN=1
CONFIG_BT_MAX_PAIRED=6
